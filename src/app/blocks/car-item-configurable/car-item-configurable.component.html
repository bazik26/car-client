<div class="car-item-configurable" [style.--primary-color]="primaryColor" [style.--secondary-color]="secondaryColor" [style.--accent-color]="accentColor">
  <div class="car-card">
    <!-- Изображения -->
    @if (showImages && carImages.length > 0) {
      <div class="car-images">
        <div class="main-image">
          <img 
            [ngSrc]="getFileUrl(carImages[0])" 
            [alt]="car.brand + ' ' + car.model"
            width="300"
            height="200"
            class="car-image"
            [priority]="false"
          />
          @if (carImages.length > 1) {
            <div class="image-count">
              <i class="fas fa-images"></i>
              <span>{{ carImages.length }}</span>
            </div>
          }
        </div>
      </div>
    }

    <!-- Основная информация -->
    <div class="car-info">
      <div class="car-header">
        <h3 class="car-title">
          {{ car.brand }} {{ car.model }}
          @if (showYear && car.year) {
            <span class="car-year">{{ car.year }}</span>
          }
        </h3>
        
        @if (showPrice && car.price) {
          <div class="car-price">{{ formatPrice(car.price) }}</div>
        }
      </div>

      <!-- Технические характеристики -->
      <div class="car-specs">
        @if (showMileage && car.mileage) {
          <div class="spec-item">
            <i class="fas fa-tachometer-alt"></i>
            <span>{{ formatMileage(car.mileage) }}</span>
          </div>
        }

        @if (showEngine && car.engine) {
          <div class="spec-item">
            <i class="fas fa-cog"></i>
            <span>{{ formatEngine(car.engine) }}</span>
          </div>
        }

        @if (showPower && car.powerValue) {
          <div class="spec-item">
            <i class="fas fa-bolt"></i>
            <span>{{ formatPower(car.powerValue) }}</span>
          </div>
        }

        @if (showFuel && car.fuel) {
          <div class="spec-item">
            <i class="fas fa-gas-pump"></i>
            <span>{{ car.fuel }}</span>
          </div>
        }

        @if (showGearbox && car.gearbox) {
          <div class="spec-item">
            <i class="fas fa-cogs"></i>
            <span>{{ car.gearbox }}</span>
          </div>
        }

        @if (showDrive && car.drive) {
          <div class="spec-item">
            <i class="fas fa-car"></i>
            <span>{{ car.drive }}</span>
          </div>
        }
      </div>

      <!-- Описание -->
      @if (showDescription && car.description) {
        <div class="car-description">
          <p>{{ car.description | slice:0:150 }}{{ car.description.length > 150 ? '...' : '' }}</p>
        </div>
      }

      <!-- Опции -->
      @if (showOptions && carOptions.length > 0) {
        <div class="car-options">
          <h4>Опции:</h4>
          <div class="options-list">
            @for (option of carOptions; track option) {
              <span class="option-tag">{{ option }}</span>
            }
          </div>
        </div>
      }

      <!-- Кнопка "Подробнее" -->
      <div class="car-actions">
        <a [routerLink]="['/cars', car.id]" class="btn btn-primary">
          <i class="fas fa-eye"></i>
          Подробнее
        </a>
      </div>
    </div>
  </div>
</div>
